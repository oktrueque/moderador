<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layouts/default">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css"/>
</head>
<th:block layout:fragment="content">
    <section class="page-content">
        <div class="page-content-inner">
            <section class="panel">
                <div class="page-content-inner">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-lg-12">
                                <h2 th:text="${dashboard.name}" style="text-align: center">Titulo</h2>
                                <section>
                                    <div class="dashboard-container">
                                        <div class="row">
                                            <div class="col-xl-3 col-lg-6 col-sm-6 col-xs-12">
                                                <div class="widget widget-seven background-warning">
                                                    <div class="widget-body no-padding-right-left-bot">
                                                        <div class="widget-body-inner">
                                                            <div class="col-lg-12">
                                                            <h5 th:text="${nuevosUsuariosReport.reportTitle}" class="text-uppercase font-size-15"></h5>
                                                            </div>
                                                            <div class="col-lg-12 min-height-50">
                                                            <div class="col-lg-6">
                                                            <i class="counter-icon icmn-users position-relative"></i>
                                                            </div>
                                                            <div class="col-lg-6">
                                                            <span class="counter-count position-relative no-position"><span class="counter-init"
                                                                                              data-from="0"
                                                                                              data-to="99" th:text="${nuevosUsuariosReport.firstDataset.data}"></span></span>
                                                            </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-lg-6 col-sm-6 col-xs-12">
                                                <div class="widget widget-seven background-danger">
                                                    <div class="widget-body no-padding-right-left-bot">
                                                        <div class="widget-body-inner">
                                                            <div class="col-lg-12">
                                                            <h5 th:text="${cantidadTotalUsuariosReport.reportTitle}" class="text-uppercase font-size-15"></h5>
                                                            </div>
                                                            <div class="col-lg-12 min-height-50">
                                                                <div class="col-lg-6">
                                                            <i class="col-lg-6 counter-icon icmn-users position-relative"></i>
                                                                </div>
                                                                <div class="col-lg-6">
                                                            <span class="counter-count position-relative no-position">
                                    <span class="counter-init" data-from="0" data-to="99" th:text="${cantidadTotalUsuariosReport.firstDataset.data}"></span>
                            </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-lg-6 col-sm-6 col-xs-12">
                                                <div class="widget widget-seven  background-warning">
                                                    <div class="widget-body no-padding-right-left-bot">
                                                        <div class="widget-body-inner">
                                                            <div class="col-lg-12">
                                                            <h5 th:text="${denunciasSinModerarReport.reportTitle}" class="text-uppercase font-size-15"></h5>
                                                            </div>
                                                            <div class="col-lg-12 min-height-50">
                                                                <div class="col-lg-6">
                                                            <i class="counter-icon icmn-users position-relative"></i>
                                                                </div>
                                                                <div class="col-lg-6">
                                                            <span class="counter-count position-relative no-position">
                                        <span class="counter-init" data-from="0" data-to="356" th:text="${denunciasSinModerarReport.firstDataset.data}"></span>
                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-lg-6 col-sm-6 col-xs-12">
                                                <div class="widget widget-seven  background-danger">
                                                    <div class="widget-body no-padding-right-left-bot">
                                                        <div class="widget-body-inner">
                                                            <div class="col-lg-12">
                                                            <h5 class="text-uppercase font-size-15" th:text="${itemsSinModerarReport.reportTitle}"></h5>
                                                            </div>
                                                            <div class="col-lg-12 min-height-50">
                                                                <div class="col-lg-6">
                                                            <i class="counter-icon icmn-users position-relative"></i>
                                                                </div>
                                                                <div class="col-lg-6">
                                                            <span class="counter-count position-relative no-position">
                                        <span class="counter-init" data-from="0" data-to="356" th:text="${itemsSinModerarReport.firstDataset.data}"></span>
                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </section>
                                <div class="col-lg-12">
                                    <div class="col-lg-6 form-group">
                                        <label for="selectMonthChart">Ver los ultimos N meses</label>
                                        <select id="selectMonthChart" class="form-control">
                                            <option value="12">12</option>
                                            <option value="6">6</option>
                                            <option value="3">3</option>
                                        </select>
                                    </div>
                                    <div class="col-lg-6 form-group">
                                        <label for="selectMonthChart2">Ver los ultimos N meses</label>
                                        <select id="selectMonthChart2" class="form-control">
                                            <option value="12">12</option>
                                            <option value="6">6</option>
                                            <option value="3">3</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="col-lg-6" id="myChartContainer">
                                        <canvas id="myChart"></canvas>
                                    </div>
                                    <div class="col-lg-6" id="myChart2Container">
                                        <canvas id="myChart2"></canvas>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="col-lg-6 form-group">
                                        <!--<label for="selectMonthChart3">Meses</label>-->
                                        <!--<select id="selectMonthChart3" class="form-control">-->
                                            <!--<option value="12">12</option>-->
                                            <!--<option value="6">6</option>-->
                                            <!--<option value="3">3</option>-->
                                        <!--</select>-->
                                    </div>
                                    <div class="col-lg-6 form-group">
                                        <label for="selectMonthChart4">Ver los ultimos N meses</label>
                                        <select id="selectMonthChart4" class="form-control">
                                            <option value="12">12</option>
                                            <option value="6">6</option>
                                            <option value="3">3</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="col-lg-6" id="myChart3Container">
                                        <canvas id="myChart3"></canvas>
                                    </div>
                                    <div class="col-lg-6" id="myChart4Container">
                                        <canvas id="myChart4"></canvas>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="col-lg-6" id="myChart5Container">
                                        <canvas id="myChart5"></canvas>
                                    </div>
                                    <div class="col-lg-6" id="myChart6Container">
                                        <canvas id="myChart6"></canvas>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="col-lg-6">
                                        <canvas id="myChart7"></canvas>
                                    </div>
                                    <div class="col-lg-6">
                                        <canvas id="myChart8"></canvas>
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <div class="col-lg-6">
                                        <canvas id="myChart9"></canvas>
                                    </div>
                                    <div class="col-lg-6">
                                        <canvas id="myChart10"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>


    </section>


    <script th:inline="javascript">
        /*<![CDATA[*/
        //        var dashboard = [[${dashboard}]];
        var itemsPorMesReport = [[${itemsPorMesReport}]];
        var truequesConcretadosVsIniciadosReport = [[${truequesConcretadosVsIniciadosReport}]];
        var itemsPorCategoriaReport = [[${itemsPorCategoriaReport}]];
        var denunciasPorMesReport = [[${denunciasPorMesReport}]];
        var itemsPorEstadoReport = [[${itemsPorEstadoReport}]];
        var usuariosPorEstadoReport = [[${usuariosPorEstadoReport}]];
        var truequesPorEstadoReport = [[${truequesPorEstadoReport}]];
        var usuariosPorScoreReport = [[${usuariosPorScoreReport}]];
        var denunciasPorTiposReport = [[${denunciasPorTiposReport}]];

        function getColorForEachOne(array) {

            var myColors = [
                '#ee8300',
                '#e22207',
                '#6d6d6d',
                '#f2926d',
                '#561d25',
                '#d3e298',
                '#305252',
                '#488286',
                '#000f08',
                '#3e2f5b',
                '#093824'
            ];

            var finalColors = [];

            array.forEach(function () {
                finalColors.push(myColors[Math.floor((Math.random() * myColors.length))])
            });
            return finalColors;
        }

        var data1 =  truequesConcretadosVsIniciadosReport.firstDataset.data.slice();
        var type = truequesConcretadosVsIniciadosReport.reportType;
        var data11 = truequesConcretadosVsIniciadosReport.secondDataset.data.slice();
        var labels = truequesConcretadosVsIniciadosReport.labels.slice();
        var title = truequesConcretadosVsIniciadosReport.reportTitle;

        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: type,
            data: {
                datasets: [
                    {
                        data:data1,
                        label: 'Concretados',
                        borderColor: '#6d6d6d',
                        backgroundColor: '#ee8300'

                    },
                    {
                        data: data11,
                        label: 'Iniciados',
                        borderColor: '#6d6d6d',
                        backgroundColor: '#e22207'
                    }


                ],
                labels: labels
            },
            options: {
                scales: {
                    yAxes: [{
                        id: 'left-y-axis',
                        type: 'linear',
                        position: 'left'
                    }]
                },
                title: {
                    display: true,
                    text: title,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });


        var data2 = itemsPorMesReport.firstDataset.data.slice();
        var labels2 = itemsPorMesReport.labels.slice();

        var ctx2 = document.getElementById('myChart2').getContext('2d');
        var myChart2 = new Chart(ctx2, {
            type: itemsPorMesReport.reportType,
            data: {
                datasets: [
                    {
                        data: data2,
                        label: itemsPorMesReport.firstDataset.label,
                        backgroundColor: '#e22207',
                        borderColor: '#000000'

                    }

                ],
                labels: labels2
            },
            options: {
                scales: {
                    yAxes: [{
                        id: 'left-y-axis',
                        type: 'linear',
                        position: 'left'
                    }]
                },

                title: {
                    display: true,
                    text: itemsPorMesReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });


        var ctx3 = document.getElementById('myChart3').getContext('2d');
        var myChart3 = new Chart(ctx3, {
            type: itemsPorCategoriaReport.reportType,
            data: {
                datasets: [
                    {
                        data: itemsPorCategoriaReport.firstDataset.data,
                        backgroundColor: '#e22207',
                        label: itemsPorCategoriaReport.firstDataset.label,
                        borderColor: '#000000'
                    }
                ],
                labels: itemsPorCategoriaReport.labels,
            },
            options: {
                title: {
                    display: true,
                    text: itemsPorCategoriaReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });

        var data4 = denunciasPorMesReport.firstDataset.data.slice();
        var labels4 = denunciasPorMesReport.labels.slice();

        var ctx4 = document.getElementById('myChart4').getContext('2d');
        var myChart4 = new Chart(ctx4, {
            type: denunciasPorMesReport.reportType,
            data: {
                datasets: [
                    {
                        data: data4,
                        label: denunciasPorMesReport.firstDataset.label,
                        backgroundColor: "#ee8300",
                        borderColor: '#6d6d6d'
                    }
                ],
                labels: labels4
            },
            options: {
                title: {
                    display: true,
                    text: denunciasPorMesReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });

        var ctx5 = document.getElementById('myChart5').getContext('2d');
        var myChart5 = new Chart(ctx5, {
            type: itemsPorEstadoReport.reportType,
            data: {
                datasets: [
                    {
                        data: itemsPorEstadoReport.firstDataset.data,
                        backgroundColor: getColorForEachOne(itemsPorEstadoReport.firstDataset.data)
                    },

                ],
                labels: itemsPorEstadoReport.labels,
            },
            options: {
                title: {
                    display: true,
                    text: itemsPorEstadoReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });

        var ctx6 = document.getElementById('myChart6').getContext('2d');
        var myChart6 = new Chart(ctx6, {
            type: usuariosPorEstadoReport.reportType,
            data: {
                datasets: [
                    {
                        data: usuariosPorEstadoReport.firstDataset.data,
                        backgroundColor: getColorForEachOne(usuariosPorEstadoReport.firstDataset.data)

                    },

                ],
                labels: usuariosPorEstadoReport.labels,
            },
            options: {
                title: {
                    display: true,
                    text: usuariosPorEstadoReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });

        var ctx7 = document.getElementById('myChart7').getContext('2d');
        var myChart7 = new Chart(ctx7, {
            type: truequesPorEstadoReport.reportType,
            data: {
                datasets: [
                    {
                        data: truequesPorEstadoReport.firstDataset.data,
                        backgroundColor: getColorForEachOne(truequesPorEstadoReport.firstDataset.data)
                    },

                ],
                labels: truequesPorEstadoReport.labels,
            },
            options: {
                title: {
                    display: true,
                    text: truequesPorEstadoReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });

        var ctx8 = document.getElementById('myChart8').getContext('2d');
        var myChart8 = new Chart(ctx8, {
            type: usuariosPorScoreReport.reportType,
            data: {
                datasets: [
                    {
                        data: usuariosPorScoreReport.firstDataset.data,
                        backgroundColor: getColorForEachOne(usuariosPorScoreReport.firstDataset.data)
                    }

                ],
                labels: usuariosPorScoreReport.labels
            },
            options: {
                title: {
                    display: true,
                    text: usuariosPorScoreReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });

        var ctx9 = document.getElementById('myChart9').getContext('2d');
        var myChart9 = new Chart(ctx9, {
            type: denunciasPorTiposReport.reportType,
            data: {
                datasets: [
                    {
                        data: denunciasPorTiposReport.firstDataset.data,
                        backgroundColor: getColorForEachOne(denunciasPorTiposReport.firstDataset.data)
                    }

                ],
                labels: denunciasPorTiposReport.labels
            },
            options: {
                title: {
                    display: true,
                    text: denunciasPorTiposReport.reportTitle,
                    fontStyle: 'bold',
                    fontSize: 16
                }
            }
        });

        function updateReportData(array,months,reportDataset) {
            if(months < array.length){
                var auxArray = array;
                auxArray.splice(0, array.length - months);
                return auxArray;
            } else {
                var auxArray = reportDataset.data.slice();
                auxArray.splice(0, 12-months);
                return auxArray;
            }
        }
        function updateReportLabels(labels,months,reportLabels) {
            if(months < labels.length) {
                var auxLabels = labels;
                auxLabels.splice(0, labels.length - months);
                return auxLabels;
            } else {
                var auxLabels = reportLabels.slice();
                auxLabels.splice(0, 12-months);
                return auxLabels;
            }
        }
        document.addEventListener("DOMContentLoaded", function () {
            $('#selectMonthChart').on('change',function () {
                let comboBoxVal = parseInt($('#selectMonthChart').val());
//                console.log('ANTES');
//                console.log('Dataset 0: '+ myChart.data.datasets[0].data);
//                console.log('Dataset 1: '+ myChart.data.datasets[1].data);
//                console.log('Labels: '+ myChart.data.labels);
                myChart.data.datasets[0].data = updateReportData(myChart.data.datasets[0].data,comboBoxVal,truequesConcretadosVsIniciadosReport.firstDataset);
                myChart.data.datasets[1].data = updateReportData(myChart.data.datasets[1].data,comboBoxVal,truequesConcretadosVsIniciadosReport.secondDataset);
                myChart.data.labels = updateReportLabels(myChart.data.labels,comboBoxVal,truequesConcretadosVsIniciadosReport.labels);
                myChart.update();
//                console.log('DESPUES');
//                console.log('Dataset 0: '+ myChart.data.datasets[0].data);
//                console.log('Dataset 1: '+ myChart.data.datasets[1].data);
//                console.log('Labels: '+ myChart.data.labels);
            });
            $('#selectMonthChart2').on('change',function () {
                let comboBoxVal = parseInt($('#selectMonthChart2').val());
//                console.log('ANTES');
//                console.log('Dataset 0: '+ myChart2.data.datasets[0].data);
//                console.log('Labels: '+ myChart2.data.labels);
                myChart2.data.datasets[0].data = updateReportData(myChart2.data.datasets[0].data,comboBoxVal,itemsPorMesReport.firstDataset);
                myChart2.data.labels = updateReportLabels(myChart2.data.labels,comboBoxVal,itemsPorMesReport.labels);
                myChart2.update();
//                console.log('DESPUES');
//                console.log('Dataset 0: '+ myChart2.data.datasets[0].data);
//                console.log('Labels: '+ myChart2.data.labels);
            });
            $('#selectMonthChart4').on('change',function () {
                let comboBoxVal = parseInt($('#selectMonthChart4').val());
//                console.log('ANTES');
//                console.log('Dataset 0: '+ myChart4.data.datasets[0].data);
//                console.log('Labels: '+ myChart4.data.labels);
                myChart4.data.datasets[0].data = updateReportData(myChart4.data.datasets[0].data,comboBoxVal,denunciasPorMesReport.firstDataset);
                myChart4.data.labels = updateReportLabels(myChart4.data.labels,comboBoxVal,denunciasPorMesReport.labels);
                myChart4.update();
//                console.log('DESPUES');
//                console.log('Dataset 0: '+ myChart4.data.datasets[0].data);
//                console.log('Labels: '+ myChart4.data.labels);
            });
        });

        /*]]>*/
    </script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

</th:block>
</html>